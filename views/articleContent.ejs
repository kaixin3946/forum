<!DOCTYPE html><!-- 这是话题文章列表  -->
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>仿byr首页</title>
    <link rel="stylesheet" href="css/bootstrap.min.css"/>
    <link rel="stylesheet" href="css/index.css"/>
    <script src="js/jquery-2.1.4.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="css/jquery-ui.min.css"/>
    <link rel="stylesheet" href="css/jquery-ui.structure.min.css"/>
    <script src="js/react.js"></script>
    <script src="js/react-dom.js"></script>
    <script src="js/browser.min.js"></script>
    <style>
        .lg{width: 100%;}
        .show{display: block;}
        .hide{display: none;}
    </style>
</head>
<body>
<!--<div class="container-fluid"></div> /.container-fluid -->
<%- include nav %>

<div id="articleList">
    <ol id="navPath" class="breadcrumb">
        <li><a href="index">糖糖论坛</a></li>
        <li><a href="#"><%= catalog1 %></a></li>
        <li><a href="articleList?blockNum=<%= blockNum %>"><%= catalog2  %></a></li>
        <li class="active">阅读文章</li>
    </ol>
    <button id="newTopic" type="button" class="btn btn-default" aria-label="Left Align">
        <a href="newTopic?blockNum=<%=blockNum%>&isTopic=1"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>新话题</a>
    </button>
    <div class="online">文章主题</div>
    <div id="articleContent">
        <div id="article_Render">
            <!--<ul>
                <li>
                    <div class="content_note">
                        <div class="note_l">
                            <table class="name_title">
                                <tr><td>=result.username%></td><td><span class="glyphicon glyphicon-user" aria-hidden="true"></span></td></tr>
                            </table>
                            <div class="clearboth"></div>
                            <div class="avatar">
                                <div>
                                    <img src="img/lily.jpg" alt=""/>
                                </div>
                            </div>
                            <table class="note_info">
                                <tr>
                                    <td colspan="2">签名</td>
                                </tr>
                                <tr>
                                    <td>等级</td><td>222</td>
                                </tr>
                                <tr>
                                    <td>文章</td><td>1</td>
                                </tr>
                                <tr>
                                    <td>积分</td><td>666</td>
                                </tr>
                            </table>
                        </div>
                        <div class="note_r">
                            <div class="cnt-title">
                                <ul>
                                    <li><a href="newTopic?blockNum==result.blockNum%>&isTopic=0&rid==result.rid%>"><span class="glyphicon glyphicon-comment" aria-hidden="true"></span>回复</a></li>
                                    <li><span class="glyphicon glyphicon-share-alt" aria-hidden="true"></span>转载</li>
                                    <li><span class="glyphicon glyphicon-heart" aria-hidden="true"></span>赞</li>
                                    <li><span class="glyphicon glyphicon-star" aria-hidden="true"></span>收藏</li>
                                </ul>
                                <div class="cnt-title-right">楼主</div>
                            </div>
                            <div class="cnt-text">
                                <ul>
                                    <li>发信人：=result.username%></li>
                                    <li>标题：=result.title%></li>
                                    <li>时间：=result.time%></li>
                                </ul>
                                =result.content%>
                            </div>

                        </div>
                    </div>
                    <div class="note-foot">
                        <div class="operate">
                            <table>
                                <tr><td><span class="glyphicon glyphicon-user" aria-hidden="true"></span>查看
                                    </td><td><span class="glyphicon glyphicon-envelope" aria-hidden="true"></span>发信
                                    </td><td><span class="glyphicon glyphicon-plus" aria-hidden="true"></span>加好友</td></tr>
                            </table>
                        </div>
                        <div class="zan">
                            <div><span class="glyphicon glyphicon-heart" aria-hidden="true"></span>赞</div>
                            <div>返回顶部</div>
                        </div>
                    </div>
                </li>-->
                <!-- 下边是回复 -->
                <!--var len=result.reply==null?0:result.reply.length;for(var i=0;i<len;i++){%>
                <li>
                    <div class="content_note">
                        <div class="note_l">
                            <table class="name_title">
                                <tr><td>=result.reply[i].username%></td><td><span class="glyphicon glyphicon-user" aria-hidden="true"></span></td></tr>
                            </table>
                            <div class="clearboth"></div>
                            <div class="avatar">
                                <div>
                                    <img src="img/lily.jpg" alt=""/>
                                </div>
                            </div>
                            <table class="note_info">
                                <tr>
                                    <td colspan="2">签名</td>
                                </tr>
                                <tr>
                                    <td>等级</td><td>222</td>
                                </tr>
                                <tr>
                                    <td>文章</td><td>1</td>
                                </tr>
                                <tr>
                                    <td>积分</td><td>666</td>
                                </tr>
                            </table>
                        </div>
                        <div class="note_r">
                            <div class="cnt-title">
                                <ul>
                                    <li><span class="glyphicon glyphicon-comment" aria-hidden="true"></span>回复</li>
                                    <li><span class="glyphicon glyphicon-share-alt" aria-hidden="true"></span>转载</li>
                                    <li><span class="glyphicon glyphicon-heart" aria-hidden="true"></span>赞</li>
                                    <li><span class="glyphicon glyphicon-star" aria-hidden="true"></span>收藏</li>
                                </ul>
                                <div class="cnt-title-right">楼主</div>
                            </div>
                            <div class="cnt-text">
                                <ul>
                                    <li>发信人：=result.reply[i].username%></li>
                                    <li>标题：=result.reply[i].title%></li>
                                    <li>时间：=result.reply[i].time%></li>
                                </ul>
                                =result.reply[i].content%>
                            </div>

                        </div>
                    </div>
                    <div class="note-foot">
                        <div class="operate">
                            <table>
                                <tr><td><span class="glyphicon glyphicon-user" aria-hidden="true"></span>查看
                                    </td><td><span class="glyphicon glyphicon-envelope" aria-hidden="true"></span>发信
                                    </td><td><span class="glyphicon glyphicon-plus" aria-hidden="true"></span>加好友</td></tr>
                            </table>
                        </div>
                        <div class="zan">
                            <div><span class="glyphicon glyphicon-heart" aria-hidden="true"></span>赞</div>
                            <div>返回顶部</div>
                        </div>
                    </div>
                </li>
                }%>
            </ul>-->
        </div>
        <!-- 分页 -->
        <nav aria-label="Page navigation">
            <ul class="pagination">
                <li>
                    <a href="#" aria-label="Previous">
                        <span aria-hidden="true">&laquo;</span>
                    </a>
                </li>
                <li><a href="#">1</a></li>
                <li><a href="#">2</a></li>
                <li><a href="#">3</a></li>
                <li><a href="#">4</a></li>
                <li><a href="#">5</a></li>
                <li>
                    <a href="#" aria-label="Next">
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                </li>
            </ul>
        </nav>
    </div>
</div>


<%- include nav-foot.ejs %>
<script type="text/babel">
var Reply=React.createClass({
    getInitialState: function() {
        return {lists: [{}]};
    },
    propTypes:{
        name:React.PropTypes.string.isRequired
    },
    componentDidMount: function(){

            var self = this;
            var blockNum=GetQueryString("blockNum");
            var rid=GetQueryString("rid");

            // 从node服务中获取图片列表
            console.log("ajax执行")
            $.ajax({
                url:"/getArticleContent",
                type:"get",
                data:{
                    "blockNum":blockNum,
                    "rid":rid
                },
                success:function(data){

                    // 更新组件状态，这会触发一次render，此处只更新Pictures数组，不会删除favorites数组
                    self.setState({lists: data.result });
                },
                error:function(){
                    alert("err");
                }
            });

        },

    render:function(){
        function formatDate(date){
            var a=new Date(date);
            var y=a.getFullYear();
            var m=a.getMonth()+1;
            var d=a.getDate();

            return y+"-"+m+"-"+d;
        }
        var owerContent=<li>
                    <div className="content_note">
                        <div className="note_l">
                            <table className="name_title">
                                <tr><td>{this.state.lists.username}</td><td><span className="glyphicon glyphicon-user" aria-hidden="true"></span></td></tr>
                            </table>
                            <div className="clearboth"></div>
                            <div className="avatar">
                                <div>
                                    <img src="img/lily.jpg" alt=""/>
                                </div>
                            </div>
                            <table className="note_info">
                                <tr>
                                    <td colspan="2">签名</td>
                                </tr>
                                <tr>
                                    <td>等级</td><td>222</td>
                                </tr>
                                <tr>
                                    <td>文章</td><td>1</td>
                                </tr>
                                <tr>
                                    <td>积分</td><td>666</td>
                                </tr>
                            </table>
                        </div>
                        <div className="note_r">
                            <div className="cnt-title">
                                <ul>
                                    <li><a href={"newTopic?blockNum="+this.state.lists.blockNum+"&isTopic=0&rid="+this.state.lists.rid}><span class="glyphicon glyphicon-comment" aria-hidden="true"></span>回复</a></li>
                                    <li><span class="glyphicon glyphicon-share-alt" aria-hidden="true"></span>转载</li>
                                    <li><span class="glyphicon glyphicon-heart" aria-hidden="true"></span>赞</li>
                                    <li><span class="glyphicon glyphicon-star" aria-hidden="true"></span>收藏</li>
                                </ul>
                                <div className="cnt-title-right">楼主</div>
                            </div>
                            <div className="cnt-text">
                                <ul>
                                    <li>发信人：{this.state.lists.username}</li>
                                    <li>标题：{this.state.lists.title}</li>
                                    <li>时间：{formatDate(this.state.lists.time)}</li>
                                </ul>
                                {this.state.lists.content}
                            </div>

                        </div>
                    </div>
                    <div className="note-foot">
                        <div className="operate">
                            <table>
                                <tr><td><span className="glyphicon glyphicon-user" aria-hidden="true"></span>查看
                                    </td><td><span className="glyphicon glyphicon-envelope" aria-hidden="true"></span>发信
                                    </td><td><span className="glyphicon glyphicon-plus" aria-hidden="true"></span>加好友</td></tr>
                            </table>
                        </div>
                        <div className="zan">
                            <div><span className="glyphicon glyphicon-heart" aria-hidden="true"></span>赞</div>
                            <div>返回顶部</div>
                        </div>
                    </div>
                </li>;
        var optionNodes =this.state.lists.reply==undefined?"": this.state.lists.reply.map(function(option){


                return <li>
                    <div className="content_note">
                        <div className="note_l">
                            <table className="name_title">
                                <tr><td>{option.username}</td><td><span className="glyphicon glyphicon-user" aria-hidden="true"></span></td></tr>
                            </table>
                            <div className="clearboth"></div>
                            <div className="avatar">
                                <div>
                                    <img src="img/lily.jpg" alt=""/>
                                </div>
                            </div>
                            <table className="note_info">
                                <tr>
                                    <td colspan="2">签名</td>
                                </tr>
                                <tr>
                                    <td>等级</td><td>222</td>
                                </tr>
                                <tr>
                                    <td>文章</td><td>1</td>
                                </tr>
                                <tr>
                                    <td>积分</td><td>666</td>
                                </tr>
                            </table>
                        </div>
                        <div className="note_r">
                            <div className="cnt-title">
                                <ul>
                                    <li><span className="glyphicon glyphicon-comment" aria-hidden="true"></span>回复</li>
                                    <li><span className="glyphicon glyphicon-share-alt" aria-hidden="true"></span>转载</li>
                                    <li><span className="glyphicon glyphicon-heart" aria-hidden="true"></span>赞</li>
                                    <li><span className="glyphicon glyphicon-star" aria-hidden="true"></span>收藏</li>
                                </ul>
                                <div className="cnt-title-right">楼主</div>
                            </div>
                            <div className="cnt-text">
                                <ul>
                                    <li>发信人：{option.username}</li>
                                    <li>标题：{option.title}</li>
                                    <li>时间：{option.time}</li>
                                </ul>
                                {option.content}
                            </div>

                        </div>
                    </div>
                    <div className="note-foot">
                        <div className="operate">
                            <table>
                                <tr><td><span className="glyphicon glyphicon-user" aria-hidden="true"></span>查看
                                    </td><td><span className="glyphicon glyphicon-envelope" aria-hidden="true"></span>发信
                                    </td><td><span className="glyphicon glyphicon-plus" aria-hidden="true"></span>加好友</td></tr>
                            </table>
                        </div>
                        <div className="zan">
                            <div><span className="glyphicon glyphicon-heart" aria-hidden="true"></span>赞</div>
                            <div>返回顶部</div>
                        </div>
                    </div>
                </li>;
            });

        return    (<ul>
                {owerContent}
                {optionNodes}
            </ul>);
    }
})

ReactDOM.render(
<Reply name="" />,
 document.getElementById('article_Render')
)
</script>
<script>

</script>
</body>
</html>